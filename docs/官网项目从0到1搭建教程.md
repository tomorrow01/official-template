# 官网项目从0到1搭建教程

## 目录
1. [项目概述](#1-项目概述)
2. [技术栈选择](#2-技术栈选择)
3. [环境准备](#3-环境准备)
4. [项目初始化](#4-项目初始化)
5. [后端服务开发](#5-后端服务开发)
6. [前端展示网站开发](#6-前端展示网站开发)
7. [管理后台开发](#7-管理后台开发)
8. [数据库设计与实现](#8-数据库设计与实现)
9. [部署架构与实践](#9-部署架构与实践)
10. [常见问题与解决方案](#10-常见问题与解决方案)
11. [总结与展望](#11-总结与展望)

---

## 1. 项目概述

本教程将指导您从零开始搭建一个完整的企业官网解决方案，包含三个主要部分：

- **前端展示网站**：面向用户的网站界面，展示公司信息、产品服务、案例等内容
- **后端API服务**：提供数据接口，处理前端和管理后台的请求
- **管理后台**：用于管理网站内容，如新闻、轮播图、案例等

通过本教程，您将学习如何构建一个功能完整、架构清晰、代码可维护的现代化Web应用。

### 1.1 项目目标

- 建立一个响应式的企业官网，支持多设备访问
- 实现完整的内容管理功能
- 构建高性能、可扩展的后端服务
- 提供友好的管理界面，方便内容更新
- 采用现代化技术栈，遵循最佳实践

## 2. 技术栈选择

### 2.1 前端展示网站

| 技术/框架 | 版本 | 用途 |
|---------|------|------|
| Nuxt.js | 3.x | 前端框架，支持服务端渲染和静态生成 |
| Vue.js | 3.x | 渐进式JavaScript框架 |
| TypeScript | 5.x | 静态类型检查 |
| Element Plus | - | UI组件库 |
| Axios | - | HTTP客户端，处理API请求 |
| Vite | - | 前端构建工具 |

### 2.2 后端服务

| 技术/框架 | 版本 | 用途 |
|---------|------|------|
| Node.js | 16.x+ | JavaScript运行环境 |
| Express.js | - | Web应用框架 |
| MongoDB | 4.x+ | NoSQL数据库 |
| Mongoose | - | MongoDB对象建模工具 |
| Multer | - | 文件上传中间件 |
| CORS | - | 跨域资源共享中间件 |

### 2.3 管理后台

| 技术/框架 | 版本 | 用途 |
|---------|------|------|
| Vue.js | 3.x | 渐进式JavaScript框架 |
| Vite | - | 前端构建工具 |
| Element Plus | - | UI组件库 |
| Vue Router | 4.x | 路由管理 |
| Axios | - | HTTP客户端，处理API请求 |

## 3. 环境准备

### 3.1 安装Node.js

访问[Node.js官网](https://nodejs.org/)下载并安装Node.js v16.x或更高版本。

安装完成后，验证版本：

```bash
node -v
npm -v
```

### 3.2 安装MongoDB

访问[MongoDB官网](https://www.mongodb.com/)下载并安装MongoDB 4.x或更高版本。

对于开发环境，您也可以使用[MongoDB Atlas](https://www.mongodb.com/atlas)云数据库服务。

### 3.3 安装代码编辑器

推荐使用[Visual Studio Code](https://code.visualstudio.com/)，并安装以下扩展：

- Vue Language Features (Volar)
- TypeScript Vue Plugin (Volar)
- ESLint
- Prettier - Code formatter

## 4. 项目初始化

### 4.1 创建项目目录结构

```bash
# 创建项目根目录
mkdir official-template
cd official-template

# 创建子目录
mkdir frontend backend admin docs

# 创建环境变量文件
touch .env
```

### 4.2 初始化后端项目

```bash
cd backend
npm init -y

# 安装依赖
npm install express mongoose cors multer dotenv
npm install --save-dev nodemon

# 创建目录结构
mkdir -p src/models src/routes src/utils uploads

touch src/index.js
```

### 4.3 初始化前端项目

使用Nuxt.js创建前端项目：

```bash
cd ../frontend
npx create-nuxt-app .

# 配置选项（根据需要选择）:
# - 选择集成TypeScript: Yes
# - 选择UI框架: Element Plus
# - 选择包管理器: npm
# - 选择渲染模式: Universal (SSR/SSG)
```

### 4.4 初始化管理后台项目

使用Vite创建Vue 3项目：

```bash
cd ../admin
npm create vite@latest . -- --template vue

# 安装依赖
npm install element-plus vue-router axios
npm install --save-dev @vitejs/plugin-vue-jsx
```

## 5. 后端服务开发

### 5.1 配置环境变量

在`backend`目录下创建`.env`文件：

```env
# 数据库连接信息
MONGO_URI=mongodb://localhost:27017/official-website

# 服务器配置
PORT=3000

# 文件上传配置
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=5000000
```

### 5.2 创建数据库连接工具

创建`backend/src/utils/db.js`：

```javascript
const mongoose = require('mongoose');
const dotenv = require('dotenv');

dotenv.config();

// 数据库连接函数
const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGO_URI, {
      useNewUrlParser: true,
      useUnifiedTopology: true,
    });
    console.log('MongoDB 连接成功');
  } catch (error) {
    console.error('MongoDB 连接失败:', error.message);
    process.exit(1);
  }
};

// 初始化默认数据
const initializeDefaultData = async () => {
  // 这里将在后续模型创建后实现
  console.log('默认数据初始化完成');
};

module.exports = {
  connectDB,
  initializeDefaultData
};
```

### 5.3 创建响应处理工具

创建`backend/src/utils/response.js`：

```javascript
// 成功响应
const successResponse = (res, data = null, message = '操作成功') => {
  return res.status(200).json({
    success: true,
    message,
    data
  });
};

// 错误响应
const errorResponse = (res, error = '操作失败', statusCode = 400) => {
  return res.status(statusCode).json({
    success: false,
    message: error.message || error
  });
};

module.exports = {
  successResponse,
  errorResponse
};
```

### 5.4 创建数据模型

#### 5.4.1 创建轮播图模型

创建`backend/src/models/Banner.js`：

```javascript
const mongoose = require('mongoose');

const BannerSchema = new mongoose.Schema({
  image: {
    type: String,
    required: true,
    trim: true
  },
  link: {
    type: String,
    trim: true
  },
  title: {
    type: String,
    trim: true
  },
  description: {
    type: String,
    trim: true
  },
  order: {
    type: Number,
    default: 0
  },
  isActive: {
    type: Boolean,
    default: true
  },
  createTime: {
    type: Date,
    default: Date.now
  }
});

module.exports = mongoose.model('Banner', BannerSchema);
```

#### 5.4.2 创建文章模型

创建`backend/src/models/Article.js`：

```javascript
const mongoose = require('mongoose');

const ArticleSchema = new mongoose.Schema({
  title: {
    type: String,
    required: true,
    trim: true
  },
  excerpt: {
    type: String,
    trim: true
  },
  content: {
    type: String,
    required: true
  },
  image: {
    type: String,
    trim: true
  },
  author: {
    type: String,
    trim: true
  },
  status: {
    type: String,
    default: 'draft',
    enum: ['draft', 'published']
  },
  createTime: {
    type: Date,
    default: Date.now
  },
  updateTime: {
    type: Date,
    default: Date.now
  },
  views: {
    type: Number,
    default: 0
  }
});

module.exports = mongoose.model('Article', ArticleSchema);
```

### 5.5 创建API路由

#### 5.5.1 创建轮播图路由

创建`backend/src/routes/banners.js`：

```javascript
const express = require('express');
const router = express.Router();
const Banner = require('../models/Banner');
const { successResponse, errorResponse } = require('../utils/response');

// 获取所有轮播图
router.get('/', async (req, res) => {
  try {
    const banners = await Banner.find({ isActive: true }).sort({ order: 1 });
    successResponse(res, banners, '轮播图获取成功');
  } catch (error) {
    errorResponse(res, error, 500);
  }
});

// 创建新轮播图
router.post('/', async (req, res) => {
  try {
    const { image, link, title, description, order, isActive } = req.body;
    
    const newBanner = new Banner({
      image,
      link,
      title,
      description,
      order,
      isActive
    });
    
    const savedBanner = await newBanner.save();
    successResponse(res, savedBanner, '轮播图创建成功');
  } catch (error) {
    errorResponse(res, error, 500);
  }
});

// 更新轮播图
router.put('/:id', async (req, res) => {
  try {
    const { id } = req.params;
    const updateData = req.body;
    
    const updatedBanner = await Banner.findByIdAndUpdate(id, updateData, { new: true });
    successResponse(res, updatedBanner, '轮播图更新成功');
  } catch (error) {
    errorResponse(res, error, 500);
  }
});

// 删除轮播图
router.delete('/:id', async (req, res) => {
  try {
    const { id } = req.params;
    
    await Banner.findByIdAndDelete(id);
    successResponse(res, null, '轮播图删除成功');
  } catch (error) {
    errorResponse(res, error, 500);
  }
});

module.exports = router;
```

### 5.6 创建主入口文件

创建`backend/src/index.js`：

```javascript
const express = require('express');
const cors = require('cors');
const multer = require('multer');
const path = require('path');
const dotenv = require('dotenv');
const { connectDB, initializeDefaultData } = require('./utils/db');

// 加载环境变量
dotenv.config();

// 创建Express应用
const app = express();

// 中间件配置
app.use(cors());
app.use(express.json());
app.use(express.urlencoded({ extended: true }));

// 文件上传配置
const storage = multer.diskStorage({
  destination: (req, file, cb) => {
    cb(null, process.env.UPLOAD_DIR || './uploads');
  },
  filename: (req, file, cb) => {
    const uniqueSuffix = Date.now() + '-' + Math.round(Math.random() * 1E9);
    cb(null, file.fieldname + '-' + uniqueSuffix + path.extname(file.originalname));
  }
});

const upload = multer({ 
  storage,
  limits: { fileSize: process.env.MAX_FILE_SIZE || 5000000 }
});

// 静态文件服务
app.use('/uploads', express.static(path.join(__dirname, '../uploads')));

// 导入路由
const bannersRouter = require('./routes/banners');

// 注册路由
app.use('/api/banners', bannersRouter);

// 健康检查接口
app.get('/health', (req, res) => {
  res.json({ status: 'ok', message: '服务运行正常' });
});

// 全局错误处理中间件
app.use((err, req, res, next) => {
  console.error('全局错误:', err);
  res.status(500).json({
    success: false,
    message: err.message || '服务器内部错误'
  });
});

// 启动服务器
const PORT = process.env.PORT || 3000;

const startServer = async () => {
  try {
    // 连接数据库
    await connectDB();
    
    // 初始化默认数据
    await initializeDefaultData();
    
    // 启动HTTP服务
    app.listen(PORT, () => {
      console.log(`服务运行在 http://localhost:${PORT}`);
      console.log('挂载 /api/banners 路由');
      console.log('挂载 /health 健康检查接口');
    });
  } catch (error) {
    console.error('启动服务器失败:', error);
    process.exit(1);
  }
};

// 启动服务器
startServer();

// 全局错误监听
process.on('unhandledRejection', (error) => {
  console.error('未捕获的Promise错误:', error);
});

process.on('uncaughtException', (error) => {
  console.error('未捕获的异常:', error);
  process.exit(1);
});
```

### 5.7 更新package.json

修改`backend/package.json`，添加启动脚本：

```json
{
  "name": "backend",
  "version": "1.0.0",
  "description": "官网后端服务",
  "main": "src/index.js",
  "scripts": {
    "start": "node src/index.js",
    "dev": "nodemon src/index.js"
  },
  "dependencies": {
    "cors": "^2.8.5",
    "dotenv": "^16.0.3",
    "express": "^4.18.2",
    "mongoose": "^7.2.0",
    "multer": "^1.4.5-lts.1"
  },
  "devDependencies": {
    "nodemon": "^2.0.22"
  }
}
```

### 5.8 启动后端服务

```bash
cd backend
npm run dev
```

服务将在 http://localhost:3000 启动。

## 6. 前端展示网站开发

### 6.1 配置Nuxt.js

修改`frontend/nuxt.config.ts`：

```typescript
export default defineNuxtConfig({
  devtools: { enabled: true },
  css: ['@/assets/css/main.css'],
  modules: [
    '@element-plus/nuxt'
  ],
  runtimeConfig: {
    public: {
      apiBase: process.env.API_BASE_URL || 'http://localhost:3000/api'
    }
  },
  app: {
    head: {
      charset: 'utf-8',
      viewport: 'width=device-width, initial-scale=1',
      title: '企业官网',
    }
  }
})
```

### 6.2 创建API请求封装

创建`frontend/api/request.ts`：

```typescript
import axios from 'axios'

const api = axios.create({
  baseURL: process.env.API_BASE_URL || 'http://localhost:3000/api',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json'
  }
})

// 请求拦截器
api.interceptors.request.use(
  (config) => {
    return config
  },
  (error) => {
    return Promise.reject(error)
  }
)

// 响应拦截器
api.interceptors.response.use(
  (response) => {
    return response.data
  },
  (error) => {
    console.error('API请求错误:', error)
    return Promise.reject(error)
  }
)

export default api
```

### 6.3 创建轮播图API

创建`frontend/api/banner.ts`：

```typescript
import api from './request'

interface Banner {
  id: string
  image: string
  link: string
  title: string
  description: string
  order: number
  isActive: boolean
}

// 获取轮播图列表
export const getBanners = async (): Promise<Banner[]> => {
  try {
    const response = await api.get('/banners')
    return response.data || []
  } catch (error) {
    console.error('获取轮播图失败:', error)
    // 返回模拟数据作为降级方案
    return [
      {
        id: '1',
        image: '/images/banner1.jpg',
        link: '/',
        title: '欢迎访问我们的官网',
        description: '专业的企业解决方案提供商',
        order: 1,
        isActive: true
      }
    ]
  }
}
```

### 6.4 创建导航栏组件

创建`frontend/components/Navbar.vue`：

```vue
<template>
  <nav class="navbar fixed w-full top-0 z-50 transition-all duration-300" :class="{ 'navbar-scrolled': isScrolled }">
    <div class="container">
      <NuxtLink to="/" class="logo" aria-label="官网首页">
        <img src="/images/logo.svg" alt="企业logo" class="logo-img">
      </NuxtLink>
      
      <!-- 桌面导航 -->
      <div class="desktop-nav">
        <div class="nav-menu">
          <NuxtLink to="/" class="nav-item" active-class="nav-item-active" @click.stop>首页</NuxtLink>
          <NuxtLink to="/about" class="nav-item" active-class="nav-item-active" @click.stop>关于我们</NuxtLink>
          <NuxtLink to="/services" class="nav-item" active-class="nav-item-active" @click.stop>核心服务</NuxtLink>
          <NuxtLink to="/cases" class="nav-item" active-class="nav-item-active" @click.stop>客户案例</NuxtLink>
          <NuxtLink to="/articles" class="nav-item" active-class="nav-item-active" @click.stop>最新动态</NuxtLink>
          <NuxtLink to="/contact" class="nav-item" active-class="nav-item-active" @click.stop>联系我们</NuxtLink>
        </div>
      </div>
      
      <!-- 移动端菜单按钮 -->
      <div class="mobile-nav">
        <button 
          @click="toggleMenu" 
          class="mobile-menu-btn"
          aria-label="打开菜单"
          :aria-expanded="mobileMenuOpen"
        >
          <span class="menu-icon" :class="{ 'menu-icon-active': mobileMenuOpen }"></span>
        </button>
      </div>
    </div>
    
    <!-- 移动端导航菜单 -->
    <transition name="mobile-menu">
      <div v-if="mobileMenuOpen" class="mobile-menu-overlay" @click="toggleMenu">
        <div class="mobile-menu" @click.stop>
          <button 
            @click="toggleMenu" 
            class="mobile-close-btn"
            aria-label="关闭菜单"
          >
            <span class="close-icon"></span>
          </button>
          <div class="mobile-nav-menu">
            <NuxtLink to="/" class="mobile-nav-item" active-class="nav-item-active" @click="toggleMenu">首页</NuxtLink>
            <NuxtLink to="/about" class="mobile-nav-item" active-class="nav-item-active" @click="toggleMenu">关于我们</NuxtLink>
            <NuxtLink to="/services" class="mobile-nav-item" active-class="nav-item-active" @click="toggleMenu">核心服务</NuxtLink>
            <NuxtLink to="/cases" class="mobile-nav-item" active-class="nav-item-active" @click="toggleMenu">客户案例</NuxtLink>
            <NuxtLink to="/articles" class="mobile-nav-item" active-class="nav-item-active" @click="toggleMenu">最新动态</NuxtLink>
            <NuxtLink to="/contact" class="mobile-nav-item" active-class="nav-item-active" @click="toggleMenu">联系我们</NuxtLink>
          </div>
        </div>
      </div>
    </transition>
  </nav>
</template>

<script setup lang="ts">
import { onMounted, onUnmounted, ref, watch } from 'vue';
import { useRouter } from 'vue-router';

const router = useRouter();
const isScrolled = ref(false);
const mobileMenuOpen = ref(false);

// 处理滚动事件，改变导航栏样式
const handleScroll = () => {
  isScrolled.value = window.scrollY > 50;
};

// 切换移动端菜单
const toggleMenu = () => {
  mobileMenuOpen.value = !mobileMenuOpen.value;
  // 防止滚动穿透
  if (typeof document !== 'undefined') {
    document.body.style.overflow = mobileMenuOpen.value ? 'hidden' : '';
    document.body.style.paddingRight = mobileMenuOpen.value ? '15px' : ''; // 防止内容跳动
    document.documentElement.style.overflow = mobileMenuOpen.value ? 'hidden' : '';
  }
};

// 监听路由变化，自动关闭移动端菜单
watch(() => router.currentRoute.value.path, () => {
  if (mobileMenuOpen.value) {
    toggleMenu();
  }
});

// 监听窗口大小变化，在桌面端时自动关闭移动端菜单
const handleResize = () => {
  if (typeof window !== 'undefined' && window.innerWidth >= 768 && mobileMenuOpen.value) {
    toggleMenu();
  }
};

onMounted(() => {
  if (typeof window !== 'undefined') {
    window.addEventListener('scroll', handleScroll);
    window.addEventListener('resize', handleResize);
    // 初始化滚动状态
    handleScroll();
  }
});

onUnmounted(() => {
  if (typeof window !== 'undefined') {
    window.removeEventListener('scroll', handleScroll);
    window.removeEventListener('resize', handleResize);
    // 清理样式
    document.body.style.overflow = '';
    document.body.style.paddingRight = '';
    document.documentElement.style.overflow = '';
  }
});
</script>

<style scoped>
/* 导航栏样式 */
.navbar {
  background-color: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  padding: 1rem 0;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  transition: all 0.3s ease-in-out;
}

.navbar-scrolled {
  padding: 0.5rem 0;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  background-color: rgba(255, 255, 255, 0.98);
}

.container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 1rem;
  max-width: 1200px;
  margin: 0 auto;
}

/* 其他样式省略... */
</style>
```

### 6.5 创建首页组件

创建`frontend/pages/index.vue`：

```vue
<template>
  <div class="home-page">
    <!-- 导航栏 -->
    <Navbar />
    
    <!-- 轮播图 -->
    <Banner />
    
    <!-- 关于我们简介 -->
    <section class="about-section">
      <div class="container">
        <h2 class="section-title">关于我们</h2>
        <p class="section-description">我们是一家专注于提供企业级解决方案的科技公司...</p>
        <NuxtLink to="/about" class="learn-more-btn">了解更多</NuxtLink>
      </div>
    </section>
    
    <!-- 核心服务 -->
    <section class="services-section">
      <div class="container">
        <h2 class="section-title">核心服务</h2>
        <div class="services-grid">
          <!-- 服务卡片将通过API获取数据后渲染 -->
        </div>
      </div>
    </section>
    
    <!-- 页脚 -->
    <Footer />
  </div>
</template>

<script setup lang="ts">
import Navbar from '@/components/Navbar.vue'
import Banner from '@/components/Banner.vue'
import Footer from '@/components/Footer.vue'
import { onMounted, ref } from 'vue'
import { getServices } from '@/api/services'

const services = ref([])
const loading = ref(false)

const loadServices = async () => {
  loading.value = true
  try {
    services.value = await getServices()
  } catch (error) {
    console.error('获取服务列表失败:', error)
    // 使用模拟数据
    services.value = [
      {
        id: '1',
        title: '网站开发',
        description: '专业的网站设计与开发服务',
        icon: 'el-icon-s-flag'
      }
    ]
  } finally {
    loading.value = false
  }
}

onMounted(() => {
  loadServices()
})
</script>

<style scoped>
.home-page {
  min-height: 100vh;
}

/* 其他样式省略... */
</style>
```

### 6.6 启动前端服务

```bash
cd frontend
npm run dev
```

前端服务将在 http://localhost:3001 启动。

## 7. 管理后台开发

### 7.1 配置Vite

修改`admin/vite.config.js`：

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import vueJsx from '@vitejs/plugin-vue-jsx'
import path from 'path'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [vue(), vueJsx()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src')
    }
  },
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:3000',
        changeOrigin: true
      }
    }
  }
})
```

### 7.2 配置路由

创建`admin/src/router/index.js`：

```javascript
import { createRouter, createWebHistory } from 'vue-router'

const routes = [
  {
    path: '/',
    redirect: '/banners'
  },
  {
    path: '/banners',
    name: 'Banners',
    component: () => import('@/views/Banners.vue'),
    meta: { title: '轮播图管理' }
  },
  {
    path: '/articles',
    name: 'Articles',
    component: () => import('@/views/Articles.vue'),
    meta: { title: '文章管理' }
  },
  {
    path: '/services',
    name: 'Services',
    component: () => import('@/views/Services.vue'),
    meta: { title: '服务管理' }
  },
  {
    path: '/cases',
    name: 'Cases',
    component: () => import('@/views/Cases.vue'),
    meta: { title: '案例管理' }
  },
  {
    path: '/content',
    name: 'Content',
    component: () => import('@/views/Content.vue'),
    meta: { title: '内容管理' }
  }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

// 路由前置守卫
router.beforeEach((to, from, next) => {
  // 设置页面标题
  document.title = to.meta.title ? `${to.meta.title} - 管理后台` : '管理后台'
  next()
})

export default router
```

### 7.3 创建API封装

创建`admin/src/utils/api.js`：

```javascript
import axios from 'axios'

const api = axios.create({
  baseURL: '/api',
  timeout: 10000,
  headers: {
    'Content-Type': 'application/json'
  }
})

// 请求拦截器
api.interceptors.request.use(
  config => {
    return config
  },
  error => {
    return Promise.reject(error)
  }
)

// 响应拦截器
api.interceptors.response.use(
  response => {
    return response.data
  },
  error => {
    console.error('API请求错误:', error)
    return Promise.reject(error)
  }
)

export default api
```

### 7.4 创建轮播图管理页面

创建`admin/src/views/Banners.vue`：

```vue
<template>
  <div class="banners-page">
    <h2 class="page-title">轮播图管理</h2>
    
    <!-- 操作按钮 -->
    <div class="operation-bar">
      <el-button 
        type="primary" 
        @click="showDialog = true"
        icon="el-icon-plus"
      >
        新增轮播图
      </el-button>
      <el-button 
        type="success" 
        @click="refreshBanners"
        icon="el-icon-refresh"
      >
        刷新数据
      </el-button>
    </div>
    
    <!-- 轮播图列表 -->
    <el-table 
      v-loading="loading"
      :data="banners" 
      style="width: 100%"
      border
    >
      <el-table-column prop="title" label="标题" width="200" />
      <el-table-column prop="link" label="链接" width="250" />
      <el-table-column label="图片" width="120">
        <template #default="scope">
          <el-image
            :src="scope.row.image"
            fit="cover"
            style="width: 80px; height: 40px"
            preview-teleported
          />
        </template>
      </el-table-column>
      <el-table-column prop="order" label="排序" width="80" />
      <el-table-column prop="isActive" label="状态" width="100">
        <template #default="scope">
          <el-switch
            v-model="scope.row.isActive"
            @change="updateBannerStatus(scope.row)"
          />
        </template>
      </el-table-column>
      <el-table-column prop="createTime" label="创建时间" width="180" />
      <el-table-column label="操作" width="150" fixed="right">
        <template #default="scope">
          <el-button 
            type="primary" 
            size="small" 
            @click="editBanner(scope.row)"
            icon="el-icon-edit"
          >
            编辑
          </el-button>
          <el-button 
            type="danger" 
            size="small" 
            @click="handleDelete(scope.row)"
            icon="el-icon-delete"
          >
            删除
          </el-button>
        </template>
      </el-table-column>
    </el-table>
    
    <!-- 新增/编辑对话框 -->
    <el-dialog
      v-model="showDialog"
      :title="currentId ? '编辑轮播图' : '新增轮播图'"
      width="600px"
    >
      <el-form
        ref="formRef"
        :model="form"
        :rules="rules"
        label-width="80px"
      >
        <el-form-item label="图片" prop="image">
          <el-upload
            v-model:file-list="imageList"
            class="avatar-uploader"
            action="/api/upload/image"
            :on-success="handleUploadSuccess"
            :show-file-list="false"
            :before-upload="beforeUpload"
          >
            <img v-if="form.image" :src="form.image" class="avatar" />
            <div v-else class="avatar-uploader-icon">
              <el-icon><Plus /></el-icon>
              <div>点击上传</div>
            </div>
          </el-upload>
        </el-form-item>
        
        <el-form-item label="标题" prop="title">
          <el-input v-model="form.title" placeholder="请输入轮播图标题" />
        </el-form-item>
        
        <el-form-item label="链接" prop="link">
          <el-input v-model="form.link" placeholder="请输入链接地址" />
        </el-form-item>
        
        <el-form-item label="描述" prop="description">
          <el-input
            v-model="form.description"
            type="textarea"
            placeholder="请输入轮播图描述"
            :rows="3"
          />
        </el-form-item>
        
        <el-form-item label="排序" prop="order">
          <el-input-number v-model="form.order" :min="0" />
        </el-form-item>
        
        <el-form-item label="状态">
          <el-switch v-model="form.isActive" />
        </el-form-item>
      </el-form>
      
      <template #footer>
        <el-button @click="closeDialog">取消</el-button>
        <el-button type="primary" @click="handleSubmit">确定</el-button>
      </template>
    </el-dialog>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue'
import { ElMessage, ElMessageBox } from 'element-plus'
import api from '@/utils/api'

const banners = ref([])
const loading = ref(false)
const showDialog = ref(false)
const currentId = ref('')
const formRef = ref()
const imageList = ref([])

// 表单数据
const form = reactive({
  title: '',
  image: '',
  link: '',
  description: '',
  order: 0,
  isActive: true
})

// 表单验证规则
const rules = {
  image: [
    { required: true, message: '请上传轮播图', trigger: 'blur' }
  ]
}

// 加载轮播图数据
const loadBanners = async () => {
  loading.value = true
  try {
    const response = await api.get('/banners')
    banners.value = response.data || []
  } catch (error) {
    ElMessage.error('加载轮播图失败')
    console.error('Failed to load banners:', error)
  } finally {
    loading.value = false
  }
}

// 刷新数据
const refreshBanners = () => {
  loadBanners()
}

// 编辑轮播图
const editBanner = (row) => {
  currentId.value = row._id || row.id
  form.title = row.title || ''
  form.image = row.image
  form.link = row.link || ''
  form.description = row.description || ''
  form.order = row.order || 0
  form.isActive = row.isActive !== undefined ? row.isActive : true
  imageList.value = form.image ? [{ url: form.image }] : []
  showDialog.value = true
}

// 提交表单
const handleSubmit = async () => {
  try {
    await formRef.value.validate()
    
    if (currentId.value) {
      // 编辑
      await api.put(`/banners/${currentId.value}`, form)
      ElMessage.success('编辑成功')
    } else {
      // 新增
      await api.post('/banners', form)
      ElMessage.success('新增成功')
    }
    
    closeDialog()
    loadBanners()
  } catch (error) {
    ElMessage.error('操作失败')
    console.error('Failed to submit banner:', error)
  }
}

// 删除轮播图
const handleDelete = async (row) => {
  try {
    await ElMessageBox.confirm('确定删除该轮播图？', '提示', { 
      type: 'warning' 
    })
    const deleteId = row._id || row.id
    await api.delete(`/banners/${deleteId}`)
    ElMessage.success('删除成功')
    loadBanners()
  } catch (error) {
    // 用户取消操作不显示错误
    if (error !== 'cancel') {
      console.error('Failed to delete banner:', error)
    }
  }
}

// 更新状态
const updateBannerStatus = async (row) => {
  try {
    await api.put(`/banners/${row._id || row.id}`, {
      isActive: row.isActive
    })
    ElMessage.success('状态更新成功')
  } catch (error) {
    // 失败时恢复原状态
    row.isActive = !row.isActive
    ElMessage.error('状态更新失败')
    console.error('Failed to update banner status:', error)
  }
}

// 上传成功处理
const handleUploadSuccess = (response) => {
  form.image = response.data.imageUrl
  imageList.value = [{ url: form.image }]
}

// 上传前校验
const beforeUpload = (file) => {
  const isImage = file.type.startsWith('image/')
  const isLt5M = file.size / 1024 / 1024 < 5
  
  if (!isImage) {
    ElMessage.error('只能上传图片文件!')
    return false
  }
  if (!isLt5M) {
    ElMessage.error('图片大小不能超过 5MB!')
    return false
  }
  
  return true
}

// 关闭对话框
const closeDialog = () => {
  showDialog.value = false
  currentId.value = ''
  formRef.value?.resetFields()
  imageList.value = []
  // 重置表单
  Object.assign(form, {
    title: '',
    image: '',
    link: '',
    description: '',
    order: 0,
    isActive: true
  })
}

// 组件挂载时加载数据
onMounted(() => {
  loadBanners()
})
</script>

<style scoped>
.banners-page {
  padding: 20px;
}

.page-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 20px;
}

.operation-bar {
  margin-bottom: 20px;
  display: flex;
  gap: 10px;
}

.avatar-uploader .avatar {
  width: 200px;
  height: 100px;
  display: block;
  object-fit: cover;
}

.avatar-uploader-icon {
  width: 200px;
  height: 100px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  border: 1px dashed #d9d9d9;
  border-radius: 6px;
  cursor: pointer;
  background-color: #f5f5f5;
}
</style>
```

### 7.5 更新main.js

修改`admin/src/main.js`：

```javascript
import { createApp } from 'vue'
import ElementPlus from 'element-plus'
import 'element-plus/dist/index.css'
import router from './router'
import App from './App.vue'

const app = createApp(App)

app.use(ElementPlus)
app.use(router)

app.mount('#app')
```

### 7.6 启动管理后台

```bash
cd admin
npm run dev
```

管理后台将在 http://localhost:5173 启动。

## 8. 数据库设计与实现

### 8.1 数据模型设计

#### 8.1.1 轮播图模型 (Banner)
- id: 唯一标识
- image: 图片URL
- link: 链接地址
- title: 标题
- description: 描述
- order: 排序序号
- isActive: 是否激活
- createTime: 创建时间

#### 8.1.2 文章模型 (Article)
- id: 唯一标识
- title: 标题
- excerpt: 摘要
- content: 内容
- image: 封面图片
- author: 作者
- status: 状态(draft/published)
- createTime: 创建时间
- updateTime: 更新时间
- views: 浏览量

#### 8.1.3 服务模型 (Service)
- id: 唯一标识
- title: 标题
- description: 描述
- icon: 图标
- order: 排序序号
- isActive: 是否激活

#### 8.1.4 案例模型 (Case)
- id: 唯一标识
- title: 标题
- description: 描述
- image: 图片
- order: 排序序号
- isActive: 是否激活

### 8.2 数据库初始化脚本

修改`backend/src/utils/db.js`，添加默认数据初始化：

```javascript
const mongoose = require('mongoose');
const dotenv = require('dotenv');

// 导入模型
const Banner = require('../models/Banner');
const Article = require('../models/Article');
const Service = require('../models/Service');
const Case = require('../models/Case');

dotenv.config();

// 数据库连接函数
const connectDB = async () => {
  try {
    await mongoose.connect(process.env.MONGO_URI, {
      useNewUrlParser: true,
      useUnifiedTopology: true,
    });
    console.log('MongoDB 连接成功');
  } catch (error) {
    console.error('MongoDB 连接失败:', error.message);
    process.exit(1);
  }
};

// 初始化默认数据
const initializeDefaultData = async () => {
  try {
    // 初始化轮播图数据
    const bannerCount = await Banner.countDocuments();
    if (bannerCount === 0) {
      const defaultBanners = [
        {
          image: '/uploads/default-banner1.jpg',
          link: '/',
          title: '欢迎访问我们的官网',
          description: '专业的企业解决方案提供商',
          order: 1,
          isActive: true
        },
        {
          image: '/uploads/default-banner2.jpg',
          link: '/services',
          title: '我们的服务',
          description: '提供全方位的技术服务',
          order: 2,
          isActive: true
        }
      ];
      await Banner.insertMany(defaultBanners);
      console.log('默认轮播图数据插入成功');
    }
    
    // 初始化服务数据
    const serviceCount = await Service.countDocuments();
    if (serviceCount === 0) {
      const defaultServices = [
        {
          title: '网站开发',
          description: '专业的网站设计与开发服务',
          icon: 'el-icon-s-flag',
          order: 1,
          isActive: true
        },
        {
          title: '移动应用开发',
          description: '定制化移动应用开发',
          icon: 'el-icon-mobile',
          order: 2,
          isActive: true
        }
      ];
      await Service.insertMany(defaultServices);
      console.log('默认服务数据插入成功');
    }
    
    // 其他默认数据初始化...
    
    console.log('默认数据初始化完成');
  } catch (error) {
    console.error('默认数据初始化失败:', error);
  }
};

module.exports = {
  connectDB,
  initializeDefaultData
};
```

## 9. 部署架构与实践

### 9.1 开发环境部署

#### 9.1.1 本地开发环境

1. 启动MongoDB服务
2. 启动后端服务
   ```bash
   cd backend
   npm run dev
   ```
3. 启动前端服务
   ```bash
   cd frontend
   npm run dev
   ```
4. 启动管理后台
   ```bash
   cd admin
   npm run dev
   ```

#### 9.1.2 环境变量配置

创建`.env`文件（在项目根目录）：

```env
# API配置
API_BASE_URL=http://localhost:3000/api

# 数据库配置
MONGO_URI=mongodb://localhost:27017/official-website

# 服务器配置
PORT=3000

# 文件上传配置
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=5000000
```

### 9.2 生产环境部署

#### 9.2.1 构建前端项目

```bash
cd frontend
npm run build
```

构建产物将在`dist`目录。

#### 9.2.2 构建管理后台

```bash
cd admin
npm run build
```

构建产物将在`dist`目录。

#### 9.2.3 部署后端服务

```bash
cd backend
npm install --production
npm install -g pm2
pm run start
```

#### 9.2.4 Nginx配置示例

```nginx
server {
    listen 80;
    server_name example.com;
    
    # 前端展示网站
    location / {
        root /path/to/frontend/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }
    
    # 管理后台
    location /admin {
        root /path/to/admin/dist;
        index index.html;
        try_files $uri $uri/ /admin/index.html;
    }
    
    # API服务
    location /api {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # 静态资源
    location /uploads {
        alias /path/to/backend/uploads;
    }
}
```

## 10. 常见问题与解决方案

### 10.1 后端服务无法启动

**问题现象**：运行`npm run dev`后，服务无法启动，报错"MongoDB连接失败"。

**解决方案**：
- 检查MongoDB服务是否正常运行
- 确认`.env`文件中的`MONGO_URI`配置正确
- 尝试使用`mongoose.set('strictQuery', false)`来解决严格查询模式问题

### 10.2 前端无法访问后端API

**问题现象**：前端请求API时出现CORS错误或Network Error。

**解决方案**：
- 检查后端是否正确配置了CORS中间件
- 确认前端API_BASE_URL配置正确
- 检查服务端口是否被占用

### 10.3 图片上传失败

**问题现象**：上传图片时提示失败。

**解决方案**：
- 确认`uploads`目录存在且有写入权限
- 检查文件大小是否超过限制
- 验证文件类型是否符合要求

## 11. 总结与展望

### 11.1 项目总结

通过本教程，我们成功从0开始搭建了一个完整的企业官网项目，包含：

1. **前端展示网站**：使用Nuxt.js 3构建，支持服务端渲染，提供良好的SEO和用户体验
2. **后端API服务**：使用Express.js和MongoDB构建，提供RESTful API接口
3. **管理后台**：使用Vue.js 3和Element Plus构建，提供直观的内容管理界面

项目采用了现代化的技术栈和最佳实践，具有良好的可扩展性和可维护性。

### 11.2 后续优化方向

1. **性能优化**：
   - 实现图片懒加载
   - 优化API请求缓存
   - 实现代码分割和按需加载

2. **功能扩展**：
   - 添加用户认证系统
   - 实现更多的内容管理功能
   - 增加数据分析和统计功能

3. **安全增强**：
   - 添加请求速率限制
   - 实现数据加密存储
   - 增强API访问控制

4. **开发体验**：
   - 添加自动化测试
   - 实现CI/CD流程
   - 完善文档和注释

---

通过本教程的学习，您现在应该能够理解并实现一个完整的企业官网解决方案。随着技术的不断发展，我们也应该持续学习和更新我们的技术栈，以构建更好的产品。